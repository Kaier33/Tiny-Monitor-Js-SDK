function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},o=function(e){return e&&e.Math==Math&&e},i=o("object"==typeof globalThis&&globalThis)||o("object"==typeof window&&window)||o("object"==typeof self&&self)||o("object"==typeof n&&n)||function(){return this}()||Function("return this")(),a={exports:{}},u=i,c=Object.defineProperty,s=function(e,t){try{c(u,e,{value:t,configurable:!0,writable:!0})}catch(r){u[e]=t}return t},l=s,f=i["__core-js_shared__"]||l("__core-js_shared__",{}),p=f;(a.exports=function(e,t){return p[e]||(p[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.20.1",mode:"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"});var d,h,g=Function.prototype,y=g.bind,v=g.call,m=y&&y.bind(v),b=y?function(e){return e&&m(v,e)}:function(e){return e&&function(){return v.apply(e,arguments)}},E=i.TypeError,O=function(e){if(null==e)throw E("Can't call method on "+e);return e},R=O,S=i.Object,w=function(e){return S(R(e))},_=w,I=b({}.hasOwnProperty),x=Object.hasOwn||function(e,t){return I(_(e),t)},T=b,j=0,k=Math.random(),P=T(1..toString),A=function(e){return"Symbol("+(void 0===e?"":e)+")_"+P(++j+k,36)},C=function(e){return"function"==typeof e},F=i,D=C,L=function(e){return D(e)?e:void 0},M=function(e,t){return arguments.length<2?L(F[e]):F[e]&&F[e][t]},N=i,H=M("navigator","userAgent")||"",B=N.process,q=N.Deno,U=B&&B.versions||q&&q.version,V=U&&U.v8;V&&(h=(d=V.split("."))[0]>0&&d[0]<4?1:+(d[0]+d[1])),!h&&H&&(!(d=H.match(/Edge\/(\d+)/))||d[1]>=74)&&(d=H.match(/Chrome\/(\d+)/))&&(h=+d[1]);var z=h,G=function(e){try{return!!e()}catch(e){return!0}},W=z,X=G,$=!!Object.getOwnPropertySymbols&&!X((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&W&&W<41})),J=$&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,K=i,Y=a.exports,Q=x,Z=A,ee=$,te=J,re=Y("wks"),ne=K.Symbol,oe=ne&&ne.for,ie=te?ne:ne&&ne.withoutSetter||Z,ae=function(e){if(!Q(re,e)||!ee&&"string"!=typeof re[e]){var t="Symbol."+e;ee&&Q(ne,e)?re[e]=ne[e]:re[e]=te&&oe?oe(t):ie(t)}return re[e]},ue={};ue[ae("toStringTag")]="z";var ce="[object z]"===String(ue),se={exports:{}},le=!G((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),fe={},pe=C,de=function(e){return"object"==typeof e?null!==e:pe(e)},he=de,ge=i.document,ye=he(ge)&&he(ge.createElement),ve=function(e){return ye?ge.createElement(e):{}},me=ve,be=!le&&!G((function(){return 7!=Object.defineProperty(me("div"),"a",{get:function(){return 7}}).a})),Ee=i,Oe=de,Re=Ee.String,Se=Ee.TypeError,we=function(e){if(Oe(e))return e;throw Se(Re(e)+" is not an object")},_e=Function.prototype.call,Ie=_e.bind?_e.bind(_e):function(){return _e.apply(_e,arguments)},xe=b({}.isPrototypeOf),Te=M,je=C,ke=xe,Pe=J,Ae=i.Object,Ce=Pe?function(e){return"symbol"==typeof e}:function(e){var t=Te("Symbol");return je(t)&&ke(t.prototype,Ae(e))},Fe=i.String,De=C,Le=function(e){try{return Fe(e)}catch(e){return"Object"}},Me=i.TypeError,Ne=function(e){if(De(e))return e;throw Me(Le(e)+" is not a function")},He=Ie,Be=C,qe=de,Ue=i.TypeError,Ve=Ie,ze=de,Ge=Ce,We=function(e,t){var r=e[t];return null==r?void 0:Ne(r)},Xe=function(e,t){var r,n;if("string"===t&&Be(r=e.toString)&&!qe(n=He(r,e)))return n;if(Be(r=e.valueOf)&&!qe(n=He(r,e)))return n;if("string"!==t&&Be(r=e.toString)&&!qe(n=He(r,e)))return n;throw Ue("Can't convert object to primitive value")},$e=ae,Je=i.TypeError,Ke=$e("toPrimitive"),Ye=function(e,t){if(!ze(e)||Ge(e))return e;var r,n=We(e,Ke);if(n){if(void 0===t&&(t="default"),r=Ve(n,e,t),!ze(r)||Ge(r))return r;throw Je("Can't convert object to primitive value")}return void 0===t&&(t="number"),Xe(e,t)},Qe=Ce,Ze=function(e){var t=Ye(e,"string");return Qe(t)?t:t+""},et=le,tt=be,rt=we,nt=Ze,ot=i.TypeError,it=Object.defineProperty;fe.f=et?it:function(e,t,r){if(rt(e),t=nt(t),rt(r),tt)try{return it(e,t,r)}catch(e){}if("get"in r||"set"in r)throw ot("Accessors not supported");return"value"in r&&(e[t]=r.value),e};var at=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},ut=fe,ct=at,st=le?function(e,t,r){return ut.f(e,t,ct(1,r))}:function(e,t,r){return e[t]=r,e},lt=C,ft=f,pt=b(Function.toString);lt(ft.inspectSource)||(ft.inspectSource=function(e){return pt(e)});var dt,ht,gt,yt=ft.inspectSource,vt=C,mt=yt,bt=i.WeakMap,Et=vt(bt)&&/native code/.test(mt(bt)),Ot=a.exports,Rt=A,St=Ot("keys"),wt=function(e){return St[e]||(St[e]=Rt(e))},_t={},It=Et,xt=i,Tt=b,jt=de,kt=st,Pt=x,At=f,Ct=wt,Ft=_t,Dt=xt.TypeError,Lt=xt.WeakMap;if(It||At.state){var Mt=At.state||(At.state=new Lt),Nt=Tt(Mt.get),Ht=Tt(Mt.has),Bt=Tt(Mt.set);dt=function(e,t){if(Ht(Mt,e))throw new Dt("Object already initialized");return t.facade=e,Bt(Mt,e,t),t},ht=function(e){return Nt(Mt,e)||{}},gt=function(e){return Ht(Mt,e)}}else{var qt=Ct("state");Ft[qt]=!0,dt=function(e,t){if(Pt(e,qt))throw new Dt("Object already initialized");return t.facade=e,kt(e,qt,t),t},ht=function(e){return Pt(e,qt)?e[qt]:{}},gt=function(e){return Pt(e,qt)}}var Ut={set:dt,get:ht,has:gt,enforce:function(e){return gt(e)?ht(e):dt(e,{})},getterFor:function(e){return function(t){var r;if(!jt(t)||(r=ht(t)).type!==e)throw Dt("Incompatible receiver, "+e+" required");return r}}},Vt=le,zt=x,Gt=Function.prototype,Wt=Vt&&Object.getOwnPropertyDescriptor,Xt=zt(Gt,"name"),$t={EXISTS:Xt,PROPER:Xt&&"something"===function(){}.name,CONFIGURABLE:Xt&&(!Vt||Vt&&Wt(Gt,"name").configurable)},Jt=i,Kt=C,Yt=x,Qt=st,Zt=s,er=yt,tr=$t.CONFIGURABLE,rr=Ut.get,nr=Ut.enforce,or=String(String).split("String");(se.exports=function(e,t,r,n){var o,i=!!n&&!!n.unsafe,a=!!n&&!!n.enumerable,u=!!n&&!!n.noTargetGet,c=n&&void 0!==n.name?n.name:t;Kt(r)&&("Symbol("===String(c).slice(0,7)&&(c="["+String(c).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!Yt(r,"name")||tr&&r.name!==c)&&Qt(r,"name",c),(o=nr(r)).source||(o.source=or.join("string"==typeof c?c:""))),e!==Jt?(i?!u&&e[t]&&(a=!0):delete e[t],a?e[t]=r:Qt(e,t,r)):a?e[t]=r:Zt(t,r)})(Function.prototype,"toString",(function(){return Kt(this)&&rr(this).source||er(this)}));var ir=b,ar=ir({}.toString),ur=ir("".slice),cr=function(e){return ur(ar(e),8,-1)},sr=i,lr=ce,fr=C,pr=cr,dr=ae("toStringTag"),hr=sr.Object,gr="Arguments"==pr(function(){return arguments}()),yr=lr?pr:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=hr(e),dr))?r:gr?pr(t):"Object"==(n=pr(t))&&fr(t.callee)?"Arguments":n},vr=yr,mr=ce?{}.toString:function(){return"[object "+vr(this)+"]"},br=ce,Er=se.exports,Or=mr;br||Er(Object.prototype,"toString",Or,{unsafe:!0});var Rr={},Sr={},wr={}.propertyIsEnumerable,_r=Object.getOwnPropertyDescriptor,Ir=_r&&!wr.call({1:2},1);Sr.f=Ir?function(e){var t=_r(this,e);return!!t&&t.enumerable}:wr;var xr=b,Tr=G,jr=cr,kr=i.Object,Pr=xr("".split),Ar=Tr((function(){return!kr("z").propertyIsEnumerable(0)}))?function(e){return"String"==jr(e)?Pr(e,""):kr(e)}:kr,Cr=O,Fr=function(e){return Ar(Cr(e))},Dr=le,Lr=Ie,Mr=Sr,Nr=at,Hr=Fr,Br=Ze,qr=x,Ur=be,Vr=Object.getOwnPropertyDescriptor;Rr.f=Dr?Vr:function(e,t){if(e=Hr(e),t=Br(t),Ur)try{return Vr(e,t)}catch(e){}if(qr(e,t))return Nr(!Lr(Mr.f,e,t),e[t])};var zr={},Gr=Math.ceil,Wr=Math.floor,Xr=function(e){var t=+e;return t!=t||0===t?0:(t>0?Wr:Gr)(t)},$r=Xr,Jr=Math.max,Kr=Math.min,Yr=function(e,t){var r=$r(e);return r<0?Jr(r+t,0):Kr(r,t)},Qr=Xr,Zr=Math.min,en=function(e){return e>0?Zr(Qr(e),9007199254740991):0},tn=function(e){return en(e.length)},rn=Fr,nn=Yr,on=tn,an=function(e){return function(t,r,n){var o,i=rn(t),a=on(i),u=nn(n,a);if(e&&r!=r){for(;a>u;)if((o=i[u++])!=o)return!0}else for(;a>u;u++)if((e||u in i)&&i[u]===r)return e||u||0;return!e&&-1}},un={includes:an(!0),indexOf:an(!1)},cn=x,sn=Fr,ln=un.indexOf,fn=_t,pn=b([].push),dn=function(e,t){var r,n=sn(e),o=0,i=[];for(r in n)!cn(fn,r)&&cn(n,r)&&pn(i,r);for(;t.length>o;)cn(n,r=t[o++])&&(~ln(i,r)||pn(i,r));return i},hn=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],gn=dn,yn=hn.concat("length","prototype");zr.f=Object.getOwnPropertyNames||function(e){return gn(e,yn)};var vn={};vn.f=Object.getOwnPropertySymbols;var mn,bn=M,En=zr,On=vn,Rn=we,Sn=b([].concat),wn=bn("Reflect","ownKeys")||function(e){var t=En.f(Rn(e)),r=On.f;return r?Sn(t,r(e)):t},_n=x,In=wn,xn=Rr,Tn=fe,jn=G,kn=C,Pn=/#|\.prototype\./,An=function(e,t){var r=Fn[Cn(e)];return r==Ln||r!=Dn&&(kn(t)?jn(t):!!t)},Cn=An.normalize=function(e){return String(e).replace(Pn,".").toLowerCase()},Fn=An.data={},Dn=An.NATIVE="N",Ln=An.POLYFILL="P",Mn=An,Nn=i,Hn=Rr.f,Bn=st,qn=se.exports,Un=s,Vn=function(e,t,r){for(var n=In(t),o=Tn.f,i=xn.f,a=0;a<n.length;a++){var u=n[a];_n(e,u)||r&&_n(r,u)||o(e,u,i(t,u))}},zn=Mn,Gn=function(e,t){var r,n,o,i,a,u=e.target,c=e.global,s=e.stat;if(r=c?Nn:s?Nn[u]||Un(u,{}):(Nn[u]||{}).prototype)for(n in t){if(i=t[n],o=e.noTargetGet?(a=Hn(r,n))&&a.value:r[n],!zn(c?n:u+(s?".":"#")+n,e.forced)&&void 0!==o){if(typeof i==typeof o)continue;Vn(i,o)}(e.sham||o&&o.sham)&&Bn(i,"sham",!0),qn(r,n,i,e)}},Wn=dn,Xn=hn,$n=Object.keys||function(e){return Wn(e,Xn)},Jn=fe,Kn=we,Yn=Fr,Qn=$n,Zn=le?Object.defineProperties:function(e,t){Kn(e);for(var r,n=Yn(t),o=Qn(t),i=o.length,a=0;i>a;)Jn.f(e,r=o[a++],n[r]);return e},eo=M("document","documentElement"),to=we,ro=Zn,no=hn,oo=_t,io=eo,ao=ve,uo=wt("IE_PROTO"),co=function(){},so=function(e){return"<script>"+e+"<\/script>"},lo=function(e){e.write(so("")),e.close();var t=e.parentWindow.Object;return e=null,t},fo=function(){try{mn=new ActiveXObject("htmlfile")}catch(e){}var e,t;fo="undefined"!=typeof document?document.domain&&mn?lo(mn):((t=ao("iframe")).style.display="none",io.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(so("document.F=Object")),e.close(),e.F):lo(mn);for(var r=no.length;r--;)delete fo.prototype[no[r]];return fo()};oo[uo]=!0;var po=Object.create||function(e,t){var r;return null!==e?(co.prototype=to(e),r=new co,co.prototype=null,r[uo]=e):r=fo(),void 0===t?r:ro(r,t)},ho=po,go=fe,yo=ae("unscopables"),vo=Array.prototype;null==vo[yo]&&go.f(vo,yo,{configurable:!0,value:ho(null)});var mo=un.includes,bo=function(e){vo[yo][e]=!0};Gn({target:"Array",proto:!0},{includes:function(e){return mo(this,e,arguments.length>1?arguments[1]:void 0)}}),bo("includes");var Eo=de,Oo=cr,Ro=ae("match"),So=function(e){var t;return Eo(e)&&(void 0!==(t=e[Ro])?!!t:"RegExp"==Oo(e))},wo=i.TypeError,_o=yr,Io=i.String,xo=function(e){if("Symbol"===_o(e))throw TypeError("Cannot convert a Symbol value to a string");return Io(e)},To=ae("match"),jo=Gn,ko=function(e){if(So(e))throw wo("The method doesn't accept regular expressions");return e},Po=O,Ao=xo,Co=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[To]=!1,"/./"[e](t)}catch(e){}}return!1},Fo=b("".indexOf);jo({target:"String",proto:!0,forced:!Co("includes")},{includes:function(e){return!!~Fo(Ao(Po(this)),Ao(ko(e)),arguments.length>1?arguments[1]:void 0)}});var Do=cr,Lo=Array.isArray||function(e){return"Array"==Do(e)},Mo=Ze,No=fe,Ho=at,Bo=function(e,t,r){var n=Mo(t);n in e?No.f(e,n,Ho(0,r)):e[n]=r},qo=b,Uo=G,Vo=C,zo=yr,Go=yt,Wo=function(){},Xo=[],$o=M("Reflect","construct"),Jo=/^\s*(?:class|function)\b/,Ko=qo(Jo.exec),Yo=!Jo.exec(Wo),Qo=function(e){if(!Vo(e))return!1;try{return $o(Wo,Xo,e),!0}catch(e){return!1}},Zo=function(e){if(!Vo(e))return!1;switch(zo(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Yo||!!Ko(Jo,Go(e))}catch(e){return!0}};Zo.sham=!0;var ei=!$o||Uo((function(){var e;return Qo(Qo.call)||!Qo(Object)||!Qo((function(){e=!0}))||e}))?Zo:Qo,ti=i,ri=Lo,ni=ei,oi=de,ii=ae("species"),ai=ti.Array,ui=function(e){var t;return ri(e)&&(t=e.constructor,(ni(t)&&(t===ai||ri(t.prototype))||oi(t)&&null===(t=t[ii]))&&(t=void 0)),void 0===t?ai:t},ci=G,si=z,li=ae("species"),fi=function(e){return si>=51||!ci((function(){var t=[];return(t.constructor={})[li]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},pi=Gn,di=i,hi=G,gi=Lo,yi=de,vi=w,mi=tn,bi=Bo,Ei=function(e,t){return new(ui(e))(0===t?0:t)},Oi=fi,Ri=z,Si=ae("isConcatSpreadable"),wi=di.TypeError,_i=Ri>=51||!hi((function(){var e=[];return e[Si]=!1,e.concat()[0]!==e})),Ii=Oi("concat"),xi=function(e){if(!yi(e))return!1;var t=e[Si];return void 0!==t?!!t:gi(e)};pi({target:"Array",proto:!0,forced:!_i||!Ii},{concat:function(e){var t,r,n,o,i,a=vi(this),u=Ei(a,0),c=0;for(t=-1,n=arguments.length;t<n;t++)if(xi(i=-1===t?a:arguments[t])){if(c+(o=mi(i))>9007199254740991)throw wi("Maximum allowed index exceeded");for(r=0;r<o;r++,c++)r in i&&bi(u,c,i[r])}else{if(c>=9007199254740991)throw wi("Maximum allowed index exceeded");bi(u,c++,i)}return u.length=c,u}});var Ti=we,ji=function(){var e=Ti(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},ki=b,Pi=$t.PROPER,Ai=se.exports,Ci=we,Fi=xe,Di=xo,Li=G,Mi=ji,Ni=RegExp.prototype,Hi=Ni.toString,Bi=ki(Mi),qi=Li((function(){return"/a/b"!=Hi.call({source:"a",flags:"b"})})),Ui=Pi&&"toString"!=Hi.name;(qi||Ui)&&Ai(RegExp.prototype,"toString",(function(){var e=Ci(this),t=Di(e.source),r=e.flags;return"/"+t+"/"+Di(void 0===r&&Fi(Ni,e)&&!("flags"in Ni)?Bi(e):r)}),{unsafe:!0});var Vi,zi,Gi=G,Wi=i.RegExp,Xi=Gi((function(){var e=Wi("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),$i=Xi||Gi((function(){return!Wi("a","y").sticky})),Ji={BROKEN_CARET:Xi||Gi((function(){var e=Wi("^r","gy");return e.lastIndex=2,null!=e.exec("str")})),MISSED_STICKY:$i,UNSUPPORTED_Y:Xi},Ki=G,Yi=i.RegExp,Qi=Ki((function(){var e=Yi(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)})),Zi=G,ea=i.RegExp,ta=Zi((function(){var e=ea("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")})),ra=Ie,na=b,oa=xo,ia=ji,aa=Ji,ua=a.exports,ca=po,sa=Ut.get,la=Qi,fa=ta,pa=ua("native-string-replace",String.prototype.replace),da=RegExp.prototype.exec,ha=da,ga=na("".charAt),ya=na("".indexOf),va=na("".replace),ma=na("".slice),ba=(zi=/b*/g,ra(da,Vi=/a/,"a"),ra(da,zi,"a"),0!==Vi.lastIndex||0!==zi.lastIndex),Ea=aa.BROKEN_CARET,Oa=void 0!==/()??/.exec("")[1];(ba||Oa||Ea||la||fa)&&(ha=function(e){var t,r,n,o,i,a,u,c=this,s=sa(c),l=oa(e),f=s.raw;if(f)return f.lastIndex=c.lastIndex,t=ra(ha,f,l),c.lastIndex=f.lastIndex,t;var p=s.groups,d=Ea&&c.sticky,h=ra(ia,c),g=c.source,y=0,v=l;if(d&&(h=va(h,"y",""),-1===ya(h,"g")&&(h+="g"),v=ma(l,c.lastIndex),c.lastIndex>0&&(!c.multiline||c.multiline&&"\n"!==ga(l,c.lastIndex-1))&&(g="(?: "+g+")",v=" "+v,y++),r=new RegExp("^(?:"+g+")",h)),Oa&&(r=new RegExp("^"+g+"$(?!\\s)",h)),ba&&(n=c.lastIndex),o=ra(da,d?r:c,v),d?o?(o.input=ma(o.input,y),o[0]=ma(o[0],y),o.index=c.lastIndex,c.lastIndex+=o[0].length):c.lastIndex=0:ba&&o&&(c.lastIndex=c.global?o.index+o[0].length:n),Oa&&o&&o.length>1&&ra(pa,o[0],r,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(o[i]=void 0)})),o&&p)for(o.groups=a=ca(null),i=0;i<p.length;i++)a[(u=p[i])[0]]=o[u[1]];return o});Gn({target:"RegExp",proto:!0,forced:/./.exec!==ha},{exec:ha});var Ra=b([].slice),Sa=Gn,wa=i,_a=Lo,Ia=ei,xa=de,Ta=Yr,ja=tn,ka=Fr,Pa=Bo,Aa=ae,Ca=Ra,Fa=fi("slice"),Da=Aa("species"),La=wa.Array,Ma=Math.max;function Na(e){var t,r=null===(t=e)?"NULL":void 0===t?"UNDEFINED":"string"==typeof t||t instanceof String?"".concat(t):t.toString();if(!r)return 0;var n,o=0;if(0===r.length)return o;for(n=0;n<r.length;n++)o=(o<<5)-o+r.charCodeAt(n),o|=0;return o<0?"n"+Math.abs(o):"p"+o}function Ha(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{if(navigator.sendBeacon&&"function"==typeof navigator.sendBeacon)navigator.sendBeacon(e,JSON.stringify(t));else{var r=new XMLHttpRequest;r.open("POST",e),r.setRequestHeader("content-type","application/json"),r.withCredentials=!0,r.send(JSON.stringify(t))}}catch(e){console.log("post err")}}Sa({target:"Array",proto:!0,forced:!Fa},{slice:function(e,t){var r,n,o,i=ka(this),a=ja(i),u=Ta(e,a),c=Ta(void 0===t?a:t,a);if(_a(i)&&(r=i.constructor,(Ia(r)&&(r===La||_a(r.prototype))||xa(r)&&null===(r=r[Da]))&&(r=void 0),r===La||void 0===r))return Ca(i,u,c);for(n=new(void 0===r?La:r)(Ma(c-u,0)),o=0;u<c;u++,o++)u in i&&Pa(n,o,i[u]);return n.length=o,n}});var Ba="vue_error",qa="unhandledrejection",Ua="script_error",Va="resource_error",za="request_error",Ga=function(){function t(r){var n=r.dsn,o=r.key,i=r.Vue,a=r.ignoreErrType;e(this,t),this.userId="",this.dsn=n,this.key=o,this.Vue=i,this.ignoreErrType=a||null,this._ERROR_STORE=[],this._DEVICE_INFO={screen_info:{availHeight:screen.availHeight||"",availWidth:screen.availWidth||"",height:screen.height,width:screen.width},language:navigator.language,userAgent:navigator.userAgent.toLocaleLowerCase()},this.initialize()}return r(t,[{key:"initialize",value:function(){this.polyfillRequestIdleCallback(),this.generateUserId(),this.proxyErrorStore(),this.collectCatchErrorFn()}},{key:"polyfillRequestIdleCallback",value:function(){window.requestIdleCallback=window.requestIdleCallback||function(e){return setTimeout((function(){e()}),1)}}},{key:"proxyErrorStore",value:function(){var e=Array.prototype,t=Object.create(e);["push","clear"].forEach((function(r){t[r]=function(){"push"===r?e[r].apply(this,arguments):"clear"===r&&(this.length=0)}})),this._ERROR_STORE.__proto__=t}},{key:"collectCatchErrorFn",value:function(){this.listenErrorHandle(),!this.shouldBeIgnoreErrType(qa)&&this.unhandledrejectionHandle(),!this.shouldBeIgnoreErrType(Ba)&&this.vueErrorHandle(),!this.shouldBeIgnoreErrType(za)&&this.overwriteXHR()}},{key:"shouldBeIgnoreErrType",value:function(e){var t=function(e,t){return Object.prototype.toString.call(e).slice(8,-1)===t}(this.ignoreErrType,"Array");return!!t&&this.ignoreErrType.includes(e)}},{key:"generateUserId",value:function(){localStorage.getItem("___monitor-js-uid___")?this.userId=localStorage.getItem("___monitor-js-uid___"):(this.userId=Na(String((new Date).getTime())+navigator.userAgent),localStorage.setItem("___monitor-js-uid___",this.userId))}},{key:"manualPost",value:function(){var e=this;e._ERROR_STORE.length&&(Ha(e.dsn+"/post",e._ERROR_STORE),e._ERROR_STORE.clear())}},{key:"clearErrorStore",value:function(){this._ERROR_STORE.clear()}},{key:"reportError",value:function(e){var t=this;this.dsn&&this.key&&window.requestIdleCallback((function(){Ha(t.dsn+"/report-err",e)}))}},{key:"generateReportData",value:function(e){var t=e.type,r=e.errorInfo;if(t||r)return{type:t,errorInfo:r,url:location.href,userId:this.userId,key:this.key,deviceInfo:this._DEVICE_INFO,timestamp:(new Date).getTime(),errorId:Na(t+JSON.stringify(r)+location.href)}}},{key:"unhandledrejectionHandle",value:function(){var e=this;window.addEventListener("unhandledrejection",(function(t){console.error("promise异常::",t.reason);var r=e.generateReportData({type:"unhandledrejection",errorInfo:{error:t.reason}});return e.reportError(r),e._ERROR_STORE.push(r),!0}))}},{key:"listenErrorHandle",value:function(){var e=this;window.addEventListener("error",(function(t){if(console.error("异常::",t),t instanceof ErrorEvent){if(e.shouldBeIgnoreErrType(Ua))return;var r=e.generateReportData({type:Ua,errorInfo:{colno:t.colno,lineno:t.lineno,message:t.message,filename:t.filename}});e.reportError(r),e._ERROR_STORE.push(r)}else if(t.target.localName){if(e.shouldBeIgnoreErrType(Va))return;var n=e.generateReportData({type:Va,errorInfo:{error:t.target.outerHTML}});e.reportError(n),e._ERROR_STORE.push(n)}}),!0)}},{key:"vueErrorHandle",value:function(){var e=this;this.Vue&&this.Vue.config&&(this.Vue.config.errorHandler=function(t,r,n){console.error("Vue_err::",t);var o="";r.$route&&(o=r.$route.path);var i=e.generateReportData({type:Ba,errorInfo:{vue_stack_err:t.stack,vue_info:"".concat(t.toString(),"-----\x3e").concat(n),route:o}});e.reportError(i),e._ERROR_STORE.push(i)})}},{key:"overwriteXHR",value:function(){if(!(!1 in window)){var e=this,t=window.XMLHttpRequest.prototype,r=t.open;t.open=function(){this._httpInfo={method:arguments[0],startTime:Date.now()},r.apply(this,arguments)};var n=t.send,o=this.replaceOriginalFn(n,"loadend",(function(){if(4===this.readyState&&this.status>=400){console.log("接口响应粗错了",this);var t=/'application\/json'/.test(this.getResponseHeader("content-type")),r=e.generateReportData({type:za,errorInfo:{status:this.status,response:t?JSON.parse(this.response):this.response,responseURL:this.responseURL,requestMethod:this._httpInfo.method,spendTime:Date.now()-this._httpInfo.startTime}});e.reportError(r),e._ERROR_STORE.push(r)}}));t.send=o}}},{key:"replaceOriginalFn",value:function(e,t,r){return function(){this.addEventListener(t,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];e.apply(this,o)}}}]),t}(),Wa=function(){function t(){e(this,t),this.monitorInstance=null}return r(t,null,[{key:"init",value:function(e){var t=e.dsn,r=e.key,n=e.Vue,o=e.ignoreErrType;t&&r&&(this.monitorInstance=new Ga({dsn:t,key:r,Vue:n,ignoreErrType:o}))}},{key:"instance",value:function(){return this.monitorInstance}},{key:"errorStore",value:function(){return this.monitorInstance._ERROR_STORE}},{key:"manualPost",value:function(){this.monitorInstance.manualPost()}},{key:"clearErrorStore",value:function(){this.monitorInstance.clearErrorStore()}}]),t}();export{Wa as default};
