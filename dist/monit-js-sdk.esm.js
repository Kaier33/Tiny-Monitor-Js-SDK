function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},o=function(e){return e&&e.Math==Math&&e},i=o("object"==typeof globalThis&&globalThis)||o("object"==typeof window&&window)||o("object"==typeof self&&self)||o("object"==typeof n&&n)||function(){return this}()||Function("return this")(),a={exports:{}},u=i,c=Object.defineProperty,s=function(e,t){try{c(u,e,{value:t,configurable:!0,writable:!0})}catch(r){u[e]=t}return t},l=s,f=i["__core-js_shared__"]||l("__core-js_shared__",{}),p=f;(a.exports=function(e,t){return p[e]||(p[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.20.1",mode:"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"});var h,d,g=Function.prototype,y=g.bind,v=g.call,m=y&&y.bind(v),b=y?function(e){return e&&m(v,e)}:function(e){return e&&function(){return v.apply(e,arguments)}},E=i.TypeError,O=function(e){if(null==e)throw E("Can't call method on "+e);return e},w=O,R=i.Object,S=function(e){return R(w(e))},_=S,I=b({}.hasOwnProperty),x=Object.hasOwn||function(e,t){return I(_(e),t)},T=b,j=0,k=Math.random(),A=T(1..toString),P=function(e){return"Symbol("+(void 0===e?"":e)+")_"+A(++j+k,36)},C=function(e){return"function"==typeof e},L=i,M=C,B=function(e){return M(e)?e:void 0},D=function(e,t){return arguments.length<2?B(L[e]):L[e]&&L[e][t]},F=i,H=D("navigator","userAgent")||"",N=F.process,U=F.Deno,q=N&&N.versions||U&&U.version,V=q&&q.v8;V&&(d=(h=V.split("."))[0]>0&&h[0]<4?1:+(h[0]+h[1])),!d&&H&&(!(h=H.match(/Edge\/(\d+)/))||h[1]>=74)&&(h=H.match(/Chrome\/(\d+)/))&&(d=+h[1]);var z=d,W=function(e){try{return!!e()}catch(e){return!0}},G=z,X=W,$=!!Object.getOwnPropertySymbols&&!X((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&G&&G<41})),J=$&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,K=i,Y=a.exports,Q=x,Z=P,ee=$,te=J,re=Y("wks"),ne=K.Symbol,oe=ne&&ne.for,ie=te?ne:ne&&ne.withoutSetter||Z,ae=function(e){if(!Q(re,e)||!ee&&"string"!=typeof re[e]){var t="Symbol."+e;ee&&Q(ne,e)?re[e]=ne[e]:re[e]=te&&oe?oe(t):ie(t)}return re[e]},ue={};ue[ae("toStringTag")]="z";var ce="[object z]"===String(ue),se={exports:{}},le=!W((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),fe={},pe=C,he=function(e){return"object"==typeof e?null!==e:pe(e)},de=he,ge=i.document,ye=de(ge)&&de(ge.createElement),ve=function(e){return ye?ge.createElement(e):{}},me=ve,be=!le&&!W((function(){return 7!=Object.defineProperty(me("div"),"a",{get:function(){return 7}}).a})),Ee=i,Oe=he,we=Ee.String,Re=Ee.TypeError,Se=function(e){if(Oe(e))return e;throw Re(we(e)+" is not an object")},_e=Function.prototype.call,Ie=_e.bind?_e.bind(_e):function(){return _e.apply(_e,arguments)},xe=b({}.isPrototypeOf),Te=D,je=C,ke=xe,Ae=J,Pe=i.Object,Ce=Ae?function(e){return"symbol"==typeof e}:function(e){var t=Te("Symbol");return je(t)&&ke(t.prototype,Pe(e))},Le=i.String,Me=C,Be=function(e){try{return Le(e)}catch(e){return"Object"}},De=i.TypeError,Fe=function(e){if(Me(e))return e;throw De(Be(e)+" is not a function")},He=Ie,Ne=C,Ue=he,qe=i.TypeError,Ve=Ie,ze=he,We=Ce,Ge=function(e,t){var r=e[t];return null==r?void 0:Fe(r)},Xe=function(e,t){var r,n;if("string"===t&&Ne(r=e.toString)&&!Ue(n=He(r,e)))return n;if(Ne(r=e.valueOf)&&!Ue(n=He(r,e)))return n;if("string"!==t&&Ne(r=e.toString)&&!Ue(n=He(r,e)))return n;throw qe("Can't convert object to primitive value")},$e=ae,Je=i.TypeError,Ke=$e("toPrimitive"),Ye=function(e,t){if(!ze(e)||We(e))return e;var r,n=Ge(e,Ke);if(n){if(void 0===t&&(t="default"),r=Ve(n,e,t),!ze(r)||We(r))return r;throw Je("Can't convert object to primitive value")}return void 0===t&&(t="number"),Xe(e,t)},Qe=Ce,Ze=function(e){var t=Ye(e,"string");return Qe(t)?t:t+""},et=le,tt=be,rt=Se,nt=Ze,ot=i.TypeError,it=Object.defineProperty;fe.f=et?it:function(e,t,r){if(rt(e),t=nt(t),rt(r),tt)try{return it(e,t,r)}catch(e){}if("get"in r||"set"in r)throw ot("Accessors not supported");return"value"in r&&(e[t]=r.value),e};var at=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},ut=fe,ct=at,st=le?function(e,t,r){return ut.f(e,t,ct(1,r))}:function(e,t,r){return e[t]=r,e},lt=C,ft=f,pt=b(Function.toString);lt(ft.inspectSource)||(ft.inspectSource=function(e){return pt(e)});var ht,dt,gt,yt=ft.inspectSource,vt=C,mt=yt,bt=i.WeakMap,Et=vt(bt)&&/native code/.test(mt(bt)),Ot=a.exports,wt=P,Rt=Ot("keys"),St=function(e){return Rt[e]||(Rt[e]=wt(e))},_t={},It=Et,xt=i,Tt=b,jt=he,kt=st,At=x,Pt=f,Ct=St,Lt=_t,Mt=xt.TypeError,Bt=xt.WeakMap;if(It||Pt.state){var Dt=Pt.state||(Pt.state=new Bt),Ft=Tt(Dt.get),Ht=Tt(Dt.has),Nt=Tt(Dt.set);ht=function(e,t){if(Ht(Dt,e))throw new Mt("Object already initialized");return t.facade=e,Nt(Dt,e,t),t},dt=function(e){return Ft(Dt,e)||{}},gt=function(e){return Ht(Dt,e)}}else{var Ut=Ct("state");Lt[Ut]=!0,ht=function(e,t){if(At(e,Ut))throw new Mt("Object already initialized");return t.facade=e,kt(e,Ut,t),t},dt=function(e){return At(e,Ut)?e[Ut]:{}},gt=function(e){return At(e,Ut)}}var qt={set:ht,get:dt,has:gt,enforce:function(e){return gt(e)?dt(e):ht(e,{})},getterFor:function(e){return function(t){var r;if(!jt(t)||(r=dt(t)).type!==e)throw Mt("Incompatible receiver, "+e+" required");return r}}},Vt=le,zt=x,Wt=Function.prototype,Gt=Vt&&Object.getOwnPropertyDescriptor,Xt=zt(Wt,"name"),$t={EXISTS:Xt,PROPER:Xt&&"something"===function(){}.name,CONFIGURABLE:Xt&&(!Vt||Vt&&Gt(Wt,"name").configurable)},Jt=i,Kt=C,Yt=x,Qt=st,Zt=s,er=yt,tr=$t.CONFIGURABLE,rr=qt.get,nr=qt.enforce,or=String(String).split("String");(se.exports=function(e,t,r,n){var o,i=!!n&&!!n.unsafe,a=!!n&&!!n.enumerable,u=!!n&&!!n.noTargetGet,c=n&&void 0!==n.name?n.name:t;Kt(r)&&("Symbol("===String(c).slice(0,7)&&(c="["+String(c).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!Yt(r,"name")||tr&&r.name!==c)&&Qt(r,"name",c),(o=nr(r)).source||(o.source=or.join("string"==typeof c?c:""))),e!==Jt?(i?!u&&e[t]&&(a=!0):delete e[t],a?e[t]=r:Qt(e,t,r)):a?e[t]=r:Zt(t,r)})(Function.prototype,"toString",(function(){return Kt(this)&&rr(this).source||er(this)}));var ir=b,ar=ir({}.toString),ur=ir("".slice),cr=function(e){return ur(ar(e),8,-1)},sr=i,lr=ce,fr=C,pr=cr,hr=ae("toStringTag"),dr=sr.Object,gr="Arguments"==pr(function(){return arguments}()),yr=lr?pr:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=dr(e),hr))?r:gr?pr(t):"Object"==(n=pr(t))&&fr(t.callee)?"Arguments":n},vr=yr,mr=ce?{}.toString:function(){return"[object "+vr(this)+"]"},br=ce,Er=se.exports,Or=mr;br||Er(Object.prototype,"toString",Or,{unsafe:!0});var wr={},Rr={},Sr={}.propertyIsEnumerable,_r=Object.getOwnPropertyDescriptor,Ir=_r&&!Sr.call({1:2},1);Rr.f=Ir?function(e){var t=_r(this,e);return!!t&&t.enumerable}:Sr;var xr=b,Tr=W,jr=cr,kr=i.Object,Ar=xr("".split),Pr=Tr((function(){return!kr("z").propertyIsEnumerable(0)}))?function(e){return"String"==jr(e)?Ar(e,""):kr(e)}:kr,Cr=O,Lr=function(e){return Pr(Cr(e))},Mr=le,Br=Ie,Dr=Rr,Fr=at,Hr=Lr,Nr=Ze,Ur=x,qr=be,Vr=Object.getOwnPropertyDescriptor;wr.f=Mr?Vr:function(e,t){if(e=Hr(e),t=Nr(t),qr)try{return Vr(e,t)}catch(e){}if(Ur(e,t))return Fr(!Br(Dr.f,e,t),e[t])};var zr={},Wr=Math.ceil,Gr=Math.floor,Xr=function(e){var t=+e;return t!=t||0===t?0:(t>0?Gr:Wr)(t)},$r=Xr,Jr=Math.max,Kr=Math.min,Yr=function(e,t){var r=$r(e);return r<0?Jr(r+t,0):Kr(r,t)},Qr=Xr,Zr=Math.min,en=function(e){return e>0?Zr(Qr(e),9007199254740991):0},tn=function(e){return en(e.length)},rn=Lr,nn=Yr,on=tn,an=function(e){return function(t,r,n){var o,i=rn(t),a=on(i),u=nn(n,a);if(e&&r!=r){for(;a>u;)if((o=i[u++])!=o)return!0}else for(;a>u;u++)if((e||u in i)&&i[u]===r)return e||u||0;return!e&&-1}},un={includes:an(!0),indexOf:an(!1)},cn=x,sn=Lr,ln=un.indexOf,fn=_t,pn=b([].push),hn=function(e,t){var r,n=sn(e),o=0,i=[];for(r in n)!cn(fn,r)&&cn(n,r)&&pn(i,r);for(;t.length>o;)cn(n,r=t[o++])&&(~ln(i,r)||pn(i,r));return i},dn=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],gn=hn,yn=dn.concat("length","prototype");zr.f=Object.getOwnPropertyNames||function(e){return gn(e,yn)};var vn={};vn.f=Object.getOwnPropertySymbols;var mn,bn=D,En=zr,On=vn,wn=Se,Rn=b([].concat),Sn=bn("Reflect","ownKeys")||function(e){var t=En.f(wn(e)),r=On.f;return r?Rn(t,r(e)):t},_n=x,In=Sn,xn=wr,Tn=fe,jn=W,kn=C,An=/#|\.prototype\./,Pn=function(e,t){var r=Ln[Cn(e)];return r==Bn||r!=Mn&&(kn(t)?jn(t):!!t)},Cn=Pn.normalize=function(e){return String(e).replace(An,".").toLowerCase()},Ln=Pn.data={},Mn=Pn.NATIVE="N",Bn=Pn.POLYFILL="P",Dn=Pn,Fn=i,Hn=wr.f,Nn=st,Un=se.exports,qn=s,Vn=function(e,t,r){for(var n=In(t),o=Tn.f,i=xn.f,a=0;a<n.length;a++){var u=n[a];_n(e,u)||r&&_n(r,u)||o(e,u,i(t,u))}},zn=Dn,Wn=function(e,t){var r,n,o,i,a,u=e.target,c=e.global,s=e.stat;if(r=c?Fn:s?Fn[u]||qn(u,{}):(Fn[u]||{}).prototype)for(n in t){if(i=t[n],o=e.noTargetGet?(a=Hn(r,n))&&a.value:r[n],!zn(c?n:u+(s?".":"#")+n,e.forced)&&void 0!==o){if(typeof i==typeof o)continue;Vn(i,o)}(e.sham||o&&o.sham)&&Nn(i,"sham",!0),Un(r,n,i,e)}},Gn=hn,Xn=dn,$n=Object.keys||function(e){return Gn(e,Xn)},Jn=fe,Kn=Se,Yn=Lr,Qn=$n,Zn=le?Object.defineProperties:function(e,t){Kn(e);for(var r,n=Yn(t),o=Qn(t),i=o.length,a=0;i>a;)Jn.f(e,r=o[a++],n[r]);return e},eo=D("document","documentElement"),to=Se,ro=Zn,no=dn,oo=_t,io=eo,ao=ve,uo=St("IE_PROTO"),co=function(){},so=function(e){return"<script>"+e+"<\/script>"},lo=function(e){e.write(so("")),e.close();var t=e.parentWindow.Object;return e=null,t},fo=function(){try{mn=new ActiveXObject("htmlfile")}catch(e){}var e,t;fo="undefined"!=typeof document?document.domain&&mn?lo(mn):((t=ao("iframe")).style.display="none",io.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(so("document.F=Object")),e.close(),e.F):lo(mn);for(var r=no.length;r--;)delete fo.prototype[no[r]];return fo()};oo[uo]=!0;var po=Object.create||function(e,t){var r;return null!==e?(co.prototype=to(e),r=new co,co.prototype=null,r[uo]=e):r=fo(),void 0===t?r:ro(r,t)},ho=po,go=fe,yo=ae("unscopables"),vo=Array.prototype;null==vo[yo]&&go.f(vo,yo,{configurable:!0,value:ho(null)});var mo=un.includes,bo=function(e){vo[yo][e]=!0};Wn({target:"Array",proto:!0},{includes:function(e){return mo(this,e,arguments.length>1?arguments[1]:void 0)}}),bo("includes");var Eo=he,Oo=cr,wo=ae("match"),Ro=function(e){var t;return Eo(e)&&(void 0!==(t=e[wo])?!!t:"RegExp"==Oo(e))},So=i.TypeError,_o=yr,Io=i.String,xo=function(e){if("Symbol"===_o(e))throw TypeError("Cannot convert a Symbol value to a string");return Io(e)},To=ae("match"),jo=Wn,ko=function(e){if(Ro(e))throw So("The method doesn't accept regular expressions");return e},Ao=O,Po=xo,Co=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[To]=!1,"/./"[e](t)}catch(e){}}return!1},Lo=b("".indexOf);jo({target:"String",proto:!0,forced:!Co("includes")},{includes:function(e){return!!~Lo(Po(Ao(this)),Po(ko(e)),arguments.length>1?arguments[1]:void 0)}});var Mo=cr,Bo=Array.isArray||function(e){return"Array"==Mo(e)},Do=Ze,Fo=fe,Ho=at,No=function(e,t,r){var n=Do(t);n in e?Fo.f(e,n,Ho(0,r)):e[n]=r},Uo=b,qo=W,Vo=C,zo=yr,Wo=yt,Go=function(){},Xo=[],$o=D("Reflect","construct"),Jo=/^\s*(?:class|function)\b/,Ko=Uo(Jo.exec),Yo=!Jo.exec(Go),Qo=function(e){if(!Vo(e))return!1;try{return $o(Go,Xo,e),!0}catch(e){return!1}},Zo=function(e){if(!Vo(e))return!1;switch(zo(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Yo||!!Ko(Jo,Wo(e))}catch(e){return!0}};Zo.sham=!0;var ei=!$o||qo((function(){var e;return Qo(Qo.call)||!Qo(Object)||!Qo((function(){e=!0}))||e}))?Zo:Qo,ti=i,ri=Bo,ni=ei,oi=he,ii=ae("species"),ai=ti.Array,ui=function(e){var t;return ri(e)&&(t=e.constructor,(ni(t)&&(t===ai||ri(t.prototype))||oi(t)&&null===(t=t[ii]))&&(t=void 0)),void 0===t?ai:t},ci=function(e,t){return new(ui(e))(0===t?0:t)},si=W,li=z,fi=ae("species"),pi=function(e){return li>=51||!si((function(){var t=[];return(t.constructor={})[fi]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},hi=Wn,di=i,gi=W,yi=Bo,vi=he,mi=S,bi=tn,Ei=No,Oi=ci,wi=pi,Ri=z,Si=ae("isConcatSpreadable"),_i=di.TypeError,Ii=Ri>=51||!gi((function(){var e=[];return e[Si]=!1,e.concat()[0]!==e})),xi=wi("concat"),Ti=function(e){if(!vi(e))return!1;var t=e[Si];return void 0!==t?!!t:yi(e)};hi({target:"Array",proto:!0,forced:!Ii||!xi},{concat:function(e){var t,r,n,o,i,a=mi(this),u=Oi(a,0),c=0;for(t=-1,n=arguments.length;t<n;t++)if(Ti(i=-1===t?a:arguments[t])){if(c+(o=bi(i))>9007199254740991)throw _i("Maximum allowed index exceeded");for(r=0;r<o;r++,c++)r in i&&Ei(u,c,i[r])}else{if(c>=9007199254740991)throw _i("Maximum allowed index exceeded");Ei(u,c++,i)}return u.length=c,u}});var ji=Se,ki=function(){var e=ji(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},Ai=b,Pi=$t.PROPER,Ci=se.exports,Li=Se,Mi=xe,Bi=xo,Di=W,Fi=ki,Hi=RegExp.prototype,Ni=Hi.toString,Ui=Ai(Fi),qi=Di((function(){return"/a/b"!=Ni.call({source:"a",flags:"b"})})),Vi=Pi&&"toString"!=Ni.name;(qi||Vi)&&Ci(RegExp.prototype,"toString",(function(){var e=Li(this),t=Bi(e.source),r=e.flags;return"/"+t+"/"+Bi(void 0===r&&Mi(Hi,e)&&!("flags"in Hi)?Ui(e):r)}),{unsafe:!0});var zi,Wi,Gi=W,Xi=i.RegExp,$i=Gi((function(){var e=Xi("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),Ji=$i||Gi((function(){return!Xi("a","y").sticky})),Ki={BROKEN_CARET:$i||Gi((function(){var e=Xi("^r","gy");return e.lastIndex=2,null!=e.exec("str")})),MISSED_STICKY:Ji,UNSUPPORTED_Y:$i},Yi=W,Qi=i.RegExp,Zi=Yi((function(){var e=Qi(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)})),ea=W,ta=i.RegExp,ra=ea((function(){var e=ta("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")})),na=Ie,oa=b,ia=xo,aa=ki,ua=Ki,ca=a.exports,sa=po,la=qt.get,fa=Zi,pa=ra,ha=ca("native-string-replace",String.prototype.replace),da=RegExp.prototype.exec,ga=da,ya=oa("".charAt),va=oa("".indexOf),ma=oa("".replace),ba=oa("".slice),Ea=(Wi=/b*/g,na(da,zi=/a/,"a"),na(da,Wi,"a"),0!==zi.lastIndex||0!==Wi.lastIndex),Oa=ua.BROKEN_CARET,wa=void 0!==/()??/.exec("")[1];(Ea||wa||Oa||fa||pa)&&(ga=function(e){var t,r,n,o,i,a,u,c=this,s=la(c),l=ia(e),f=s.raw;if(f)return f.lastIndex=c.lastIndex,t=na(ga,f,l),c.lastIndex=f.lastIndex,t;var p=s.groups,h=Oa&&c.sticky,d=na(aa,c),g=c.source,y=0,v=l;if(h&&(d=ma(d,"y",""),-1===va(d,"g")&&(d+="g"),v=ba(l,c.lastIndex),c.lastIndex>0&&(!c.multiline||c.multiline&&"\n"!==ya(l,c.lastIndex-1))&&(g="(?: "+g+")",v=" "+v,y++),r=new RegExp("^(?:"+g+")",d)),wa&&(r=new RegExp("^"+g+"$(?!\\s)",d)),Ea&&(n=c.lastIndex),o=na(da,h?r:c,v),h?o?(o.input=ba(o.input,y),o[0]=ba(o[0],y),o.index=c.lastIndex,c.lastIndex+=o[0].length):c.lastIndex=0:Ea&&o&&(c.lastIndex=c.global?o.index+o[0].length:n),wa&&o&&o.length>1&&na(ha,o[0],r,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(o[i]=void 0)})),o&&p)for(o.groups=a=sa(null),i=0;i<p.length;i++)a[(u=p[i])[0]]=o[u[1]];return o});Wn({target:"RegExp",proto:!0,forced:/./.exec!==ga},{exec:ga});var Ra=Wn,Sa=i,_a=Yr,Ia=Xr,xa=tn,Ta=S,ja=ci,ka=No,Aa=pi("splice"),Pa=Sa.TypeError,Ca=Math.max,La=Math.min;Ra({target:"Array",proto:!0,forced:!Aa},{splice:function(e,t){var r,n,o,i,a,u,c=Ta(this),s=xa(c),l=_a(e,s),f=arguments.length;if(0===f?r=n=0:1===f?(r=0,n=s-l):(r=f-2,n=La(Ca(Ia(t),0),s-l)),s+r-n>9007199254740991)throw Pa("Maximum allowed length exceeded");for(o=ja(c,n),i=0;i<n;i++)(a=l+i)in c&&ka(o,i,c[a]);if(o.length=n,r<n){for(i=l;i<s-n;i++)u=i+r,(a=i+n)in c?c[u]=c[a]:delete c[u];for(i=s;i>s-n+r;i--)delete c[i-1]}else if(r>n)for(i=s-n;i>l;i--)u=i+r-1,(a=i+n-1)in c?c[u]=c[a]:delete c[u];for(i=0;i<r;i++)c[i+l]=arguments[i+2];return c.length=s-n+r,o}});var Ma=b([].slice),Ba=Wn,Da=i,Fa=Bo,Ha=ei,Na=he,Ua=Yr,qa=tn,Va=Lr,za=No,Wa=ae,Ga=Ma,Xa=pi("slice"),$a=Wa("species"),Ja=Da.Array,Ka=Math.max;function Ya(e){var t,r=null===(t=e)?"NULL":void 0===t?"UNDEFINED":"string"==typeof t||t instanceof String?"".concat(t):t.toString();if(!r)return 0;var n,o=0;if(0===r.length)return o;for(n=0;n<r.length;n++)o=(o<<5)-o+r.charCodeAt(n),o|=0;return o<0?"n"+Math.abs(o):"p"+o}function Qa(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{if(navigator.sendBeacon&&"function"==typeof navigator.sendBeacon)navigator.sendBeacon(e,JSON.stringify(t));else{var r=new XMLHttpRequest;r.open("POST",e),r.setRequestHeader("content-type","application/json"),r.withCredentials=!0,r.send(JSON.stringify(t))}}catch(e){console.log("post err")}}Ba({target:"Array",proto:!0,forced:!Xa},{slice:function(e,t){var r,n,o,i=Va(this),a=qa(i),u=Ua(e,a),c=Ua(void 0===t?a:t,a);if(Fa(i)&&(r=i.constructor,(Ha(r)&&(r===Ja||Fa(r.prototype))||Na(r)&&null===(r=r[$a]))&&(r=void 0),r===Ja||void 0===r))return Ga(i,u,c);for(n=new(void 0===r?Ja:r)(Ka(c-u,0)),o=0;u<c;u++,o++)u in i&&za(n,o,i[u]);return n.length=o,n}});var Za="vue_error",eu="unhandledrejection",tu="script_error",ru="resource_error",nu="request_error",ou=function(){function t(r){var n=r.dsn,o=r.key,i=r.Vue,a=r.ignoreErrType;r.maxBreadcrumb;var u=r.immediately;e(this,t),this.userId="",this.dsn=n,this.key=o,this.Vue=i,this.immediately=u||!1,this.maxBreadcrumb=50,this.ignoreErrType=a||null,this.breadcrumbs=[],this._ERROR_STORE=[],this._DEVICE_INFO={screen_info:{availHeight:screen.availHeight||"",availWidth:screen.availWidth||"",height:screen.height,width:screen.width},language:navigator.language,userAgent:navigator.userAgent.toLocaleLowerCase()},this.initialize()}return r(t,[{key:"initialize",value:function(){this.polyfillRequestIdleCallback(),this.generateUserId(),this.proxyErrorStore(),this.collectCatchErrorFn(),this.collectBehaviorTrack()}},{key:"polyfillRequestIdleCallback",value:function(){window.requestIdleCallback=window.requestIdleCallback||function(e){return setTimeout((function(){e()}),1)}}},{key:"proxyErrorStore",value:function(){var e=Array.prototype,t=Object.create(e);["push","clear"].forEach((function(r){t[r]=function(){"push"===r?e[r].apply(this,arguments):"clear"===r&&(this.length=0)}})),this._ERROR_STORE.__proto__=t}},{key:"collectCatchErrorFn",value:function(){this.listenErrorHandle(),!this.shouldBeIgnoreErrType(eu)&&this.unhandledrejectionHandle(),!this.shouldBeIgnoreErrType(Za)&&this.vueErrorHandle(),!this.shouldBeIgnoreErrType(nu)&&this.overwriteXHR()}},{key:"shouldBeIgnoreErrType",value:function(e){var t=function(e,t){return Object.prototype.toString.call(e).slice(8,-1)===t}(this.ignoreErrType,"Array");return!!t&&this.ignoreErrType.includes(e)}},{key:"generateUserId",value:function(){localStorage.getItem("___monitor-js-uid___")?this.userId=localStorage.getItem("___monitor-js-uid___"):(this.userId=Ya(String((new Date).getTime())+navigator.userAgent),localStorage.setItem("___monitor-js-uid___",this.userId))}},{key:"manualPost",value:function(){var e=this;e._ERROR_STORE.length&&(Qa(e.dsn+"/post",e._ERROR_STORE),e._ERROR_STORE.clear())}},{key:"clearErrorStore",value:function(){this._ERROR_STORE.clear()}},{key:"reportError",value:function(e){var t=this;this.dsn&&this.key&&(this.immediately?Qa(this.dsn+"/report-err",e):window.requestIdleCallback((function(){Qa(t.dsn+"/report-err",e)})))}},{key:"generateReportData",value:function(e){var t=e.type,r=e.errorInfo;if(t||r)return{error_info:{type:t,errorInfo:r,url:location.href,userId:this.userId,key:this.key,deviceInfo:this._DEVICE_INFO,timestamp:(new Date).getTime(),errorId:Ya(t+JSON.stringify(r)+location.href)},breadcrumb_trail:this.breadcrumbs}}},{key:"unhandledrejectionHandle",value:function(){var e=this;window.addEventListener("unhandledrejection",(function(t){console.log("promise异常:",t);var r=e.generateReportData({type:"unhandledrejection",errorInfo:{error:{message:"string"==typeof t.reason?t.reason:t.reason.message,stack:t.reason.stack||""}}});return e.reportError(r),e._ERROR_STORE.push(r),!0}))}},{key:"listenErrorHandle",value:function(){var e=this;window.addEventListener("error",(function(t){if(t.preventDefault(),console.log("异常::",t),t instanceof ErrorEvent){if(e.shouldBeIgnoreErrType(tu))return;var r=e.generateReportData({type:tu,errorInfo:{colno:t.colno,lineno:t.lineno,message:t.message,filename:t.filename}});e.reportError(r),e._ERROR_STORE.push(r)}else if(t.target.localName){if(e.shouldBeIgnoreErrType(ru))return;var n=e.generateReportData({type:ru,errorInfo:{error:t.target.outerHTML}});e.reportError(n),e._ERROR_STORE.push(n)}}),!0)}},{key:"vueErrorHandle",value:function(){var e=this;this.Vue&&this.Vue.config&&(this.Vue.config.errorHandler=function(t,r,n){console.error("Vue_err::",t);var o="";r.$route&&(o=r.$route.path);var i=e.generateReportData({type:Za,errorInfo:{vue_stack_err:t.stack,vue_info:"".concat(t.toString(),"-----\x3e").concat(n),route:o}});e.reportError(i),e._ERROR_STORE.push(i)})}},{key:"overwriteXHR",value:function(){if(!(!1 in window)){var e=this,t=window.XMLHttpRequest.prototype,r=t.open;t.open=function(){this._httpInfo={method:arguments[0],startTime:Date.now()},r.apply(this,arguments)};var n=t.send,o=this.replaceOriginalFn(n,"loadend",(function(){if(4===this.readyState&&this.status>=400){console.log("接口响应粗错了",this);var t=/'application\/json'/.test(this.getResponseHeader("content-type")),r=e.generateReportData({type:nu,errorInfo:{status:this.status,response:t?JSON.parse(this.response):this.response,responseURL:this.responseURL,requestMethod:this._httpInfo.method,spendTime:Date.now()-this._httpInfo.startTime}});e.reportError(r),e._ERROR_STORE.push(r)}}));t.send=o}}},{key:"replaceOriginalFn",value:function(e,t,r){return function(){this.addEventListener(t,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];e.apply(this,o)}}},{key:"collectBehaviorTrack",value:function(){this.onListenClick()}},{key:"onListenClick",value:function(){var e=this;window.addEventListener("mousedown",(function(t){var r=t.target,n=r.getBoundingClientRect(),o=n.top,i=n.left;e.pushToBreadcrumbs({top:o,left:i,type:"behavior",subType:"click",target:r.tagName,outerHTML:r.outerHTML,innerHTML:r.innerHTML,width:r.offsetWidth,height:r.offsetHeight,pageURL:location.href})}))}},{key:"pushToBreadcrumbs",value:function(e){this.breadcrumbs.length>this.maxBreadcrumb&&this.breadcrumbs.splice(0,this.maxBreadcrumb>>1),this.breadcrumbs.push(e)}}]),t}(),iu=function(){function t(){e(this,t),this.monitorInstance=null}return r(t,null,[{key:"init",value:function(e){var t=e.dsn,r=e.key,n=e.Vue,o=e.ignoreErrType;t&&r&&(this.monitorInstance=new ou({dsn:t,key:r,Vue:n,ignoreErrType:o}))}},{key:"instance",value:function(){return this.monitorInstance}},{key:"errorStore",value:function(){return this.monitorInstance._ERROR_STORE}},{key:"manualPost",value:function(){this.monitorInstance.manualPost()}},{key:"clearErrorStore",value:function(){this.monitorInstance.clearErrorStore()}}]),t}();export{iu as default};
